<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>H0llyLP Resident Evil Marathon</title>

<link rel="icon" type="image/png" href="holly.png">

<link href="https://fonts.googleapis.com/css2?family=Nosifer&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">

<style>

@font-face {
    font-family: "ResidentEvil7";
    src: url("residentevil7rusbylyajka.otf") format("opentype");

}

@font-face {
    font-family: "Compacta";
    src: url("Compacta Std Regular.otf") format("opentype");

}




body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    color: #fff;
    position: relative;
    min-height: 100vh;
    overflow-x: hidden;
    overflow-y: auto;

    /* Hintergrundbild */
    background: url('resident-evil-requiem-9.jpg') center/cover no-repeat fixed;
}
body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: inherit; /* gleiche Hintergrundbild wie body */
    filter: blur(15px) brightness(0.7); /* weniger stark blur + heller */
    opacity: 0.9; /* etwas transparenter, weiche Kanten */
    z-index: -1; /* hinter allen Inhalten */
}

h1 {
    font-family: "ResidentEvil7";
    font-size: clamp(3rem, 6vw, 5rem);
    margin-bottom: 35px;
    display: flex;
    -webkit-font-smoothing: antialiased; /* Chrome, Safari */
    -moz-osx-font-smoothing: grayscale;  /* Firefox */
    justify-content: center;
    align-items: center;
    gap: 10px; /* Abstand zwischen Text und Twitch-Logo */
}

.red-letter {
    color: #ff2e2e;
    display: inline-block;  /* verhindert unerwünschten Abstand */
    margin: 0;              /* reduziert Abstand zu den folgenden Buchstaben */
}

.twitch-logo {
    height: 1em;        /* gleich hoch wie Text auf Desktop */
    width: auto;
    cursor: pointer;
    display: inline-block;
    vertical-align: middle; /* zentriert das Logo perfekt zur Textmitte */
}

/* GRID */
.grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 18px;
    padding: 0 20px; /* neuer Innenabstand links und rechts */
    box-sizing: border-box; /* damit Padding nicht die Breite sprengt */
}

.game {
    opacity: 0;
    transform: translateY(20px);
     transition: transform 0.25s ease, 
                box-shadow 0.4s ease, /* langsamer, smoother */
                border-color 0.3s ease;
    background-color: #080152;
    border-radius: 14px;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
}

/* Fade-in Animation */
.game.fade-in {
    animation: fadeInUp 0.8s ease forwards;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

#top-section {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: flex-start; /* oder center für mittige Anordnung */
}

/* Hover bleibt immer greifbar */
.game:hover {
    transform: translateY(0) scale(1.05); /* Skaliert leicht, setzt translateY=0 */
    box-shadow: 0 0 25px rgba(255,46,46,.7);
}


/* Aktive / nicht abgeschlossene Spiele */
.game.active {
    border-color: #ff2e2e; /* bleibt rot */
    box-shadow: 0 0 25px rgba(163, 45, 15, 0.7); /* neuer Glow: #a32d0f */
}

/* Abgeschlossene Spiele */
.game.done {
    border-color: #2ecc71; /* bleibt grün */
    box-shadow: 0 0 20px rgba(48,146,32,0.6); /* neuer Glow: #309220 */
}

.game img {
    width: 100%;
    height: clamp(190px, 28vw, 260px);
    object-fit: cover;
}

.game-title {
    font-family: "Compacta", sans-serif;
    color: rgba(230, 230, 210, 1);
    font-size: clamp(18px, 5vw, 36px); /* etwas kleiner für lange Titel */
    text-align: center;
    line-height: 1.2;
    letter-spacing: 0.5px;

    -webkit-text-stroke: 1.2px #373046;
    text-stroke: 1.2px #373046;

    text-shadow: 0.4px 0.4px 0 #373046, 
                -0.4px 0.4px 0 #373046, 
                 0.4px -0.4px 0 #373046, 
                -0.4px -0.4px 0 #373046;

    display: flex;
    justify-content: center;   
    align-items: center;       
    padding: 8px 10px;        /* genug Abstand rundherum */
    box-sizing: border-box;    
    white-space: normal;       /* Zeilenumbruch erlauben */
    word-break: break-word;    /* lange Worte umbrechen */
    text-align: center;        /* zentriert */
}


.modal-backdrop {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.5); /* halbtransparenter Hintergrund für den Rest */
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 999;
    padding: 15px;
    overflow-y: auto;
}

/*
.modal::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background-image: var(--modal-bg);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    filter: blur(40px) brightness(0.3);
    border-radius: 20px;
    z-index: 0;
}
*/


/* Responsive: kein Bild auf kleineren Geräten */
@media(max-width: 700px){
    .modal-bottom {
        flex-direction: column;
    }
    .image-wrapper {
        display: none;
    }
}

/* Typewriter Animation */
@keyframes typing {
    from { width: 0; }
    to { width: 100%; }
}

@keyframes blinkCursor {
    0%, 100% { border-color: transparent; }
    50% { border-color: #ff2e2e; }
}



/* Overlay */
#startOverlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  color: #fff;
  font-family: Arial, sans-serif;
  font-size: 2rem;
  cursor: pointer;
  text-align: center;
  opacity: 1;
  transition: opacity 3s ease;
  user-select: none;
}

#startOverlay.fade-out {
  opacity: 0;
}

/* Glow-Effekt im Idle 
#startOverlay text {
  filter: drop-shadow(0 0 5px #ffffff);
  // animation: glowPulse 1.5s infinite alternate;
} */

@keyframes glowPulse {
  from { filter: drop-shadow(0 0 5px #ff2e2e); }
  to   { filter: drop-shadow(0 0 20px #ff2e2e); }
}

/* Weiß aufblitzen */
#startOverlay.flash {
  animation: flashWhite 0.3s ease forwards;
}

@keyframes flashWhite {
  0%   { background-color: rgba(255,255,255,0.9); }
  100% { background-color: rgba(0,0,0,0.85); }
}

.image-wrapper {
    width: 100%;
    height: 100%;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 8px 20px rgba(0,0,0,0.5), 0 0 10px rgba(0,0,0,0.2);
}

.image-wrapper img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    display: block;
    border-radius: 12px;
}

/* Twitch-Section */
  #twitch-stream {
    width: 100%;
    background: #000; /* harte Kante */
    padding: 50px 0;
    margin-top: 50px; /* Abstand nach oben vom Grid */
    text-align: center;
}

  #twitch-stream h2 {
    color: #f0f0f0;
    font-family: Arial, sans-serif;
    margin-bottom: 30px;
    font-size: clamp(1.5rem, 4vw, 2rem);
  }

  /* Twitch Embed responsiv */
  #twitch-stream .twitch-embed-wrapper {
    position: relative;
    padding-bottom: 56.25%; /* 16:9 Ratio */
    height: 0;
    overflow: hidden;
    width: 100%;
  }

  #twitch-stream .twitch-embed-wrapper iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 0;
  }

.modal.hard-edge {
    background: #0d0e23;
    border-radius: 0;
    width: 90%;
    max-width: 900px;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    color: #fff;

    /* Metallischer Rahmen */
    border: 6px solid; /* doppelt so dick */
    border-image-slice: 1;
    border-image-source: linear-gradient(135deg, #464545, #a3a3a3, #726e6d);

    position: relative; /* für X-Button falls benötigt */
}
/* Header */
.modal-top {
    display: flex;
    gap: 15px;
    padding: 20px;
    background: #130e60;  /* Header dunkelblau */
    align-items: center;

    /* Metallischer Border unten */
    border-bottom: 3px solid;
    border-image-slice: 1;
    border-image-source: linear-gradient(90deg, #a3a3a3, #464545, #726e6d);
}

.modal-left {
    flex: 1;
}

.modal-header {
    font-family: 'Share Tech Mono', monospace;
    font-size: clamp(1rem, 2vw, 1.5rem); /* deutlich größer */
    color: #f0f0f0;
    white-space: nowrap;
    overflow: hidden;
}

.modal-right-gif {
    position: absolute;
    top: 0;
    right: 0;
    height: auto; /* Höhe via JS gesetzt */
    display: flex;
    align-items: stretch;
    overflow: visible; /* damit Border sichtbar ist */
}

.modal-right-gif img {
    height: 100%;   /* volle Containerhöhe, also exakt Headerhöhe */
    width: auto;
    object-fit: cover;
}
/* GIF bei kleinen Bildschirmen ausblenden */
@media (max-width: 700px) {
    .modal-right-gif {
        display: none;
    }
}

/* Untere + linke "Border" via Pseudo-Element */
.modal-right-gif::before {
    content: "";
    position: absolute;
    left: 0;
    width: 100%;    /* untere Border */
    height: 8px;    /* Dicke */
    background: #141414;
}

.modal-right-gif::after {
    content: "";
    position: absolute;
    bottom: 0;
    width: 8px;    /* linke Border */
    height: 100%;   /* gesamte Höhe */
    background: linear-gradient(to bottom, #464545, #726e6d, #141414);
}

.modal-right-gif,
.image-wrapper,
.modal-left-content {
    box-shadow: 0 6px 15px rgba(0,0,0,0.5), 0 0 8px rgba(0,0,0,0.2);
}
/* Untere Sektion */
.modal-bottom {
    display: flex;
    gap: 0; /* kein Abstand zwischen Bild und Textbereich */
    padding: 0;
    border-top: 6px solid; /* doppelt so dick wie vorher */
    border-image-slice: 1;
    border-image-source: linear-gradient(135deg, #c0c0c0, #ffffff, #808080);
}
.modal-bottom {
    display: flex;
    border-top: 3px solid #ff2e2e; /* Metall-Border */
}

/* Text Content 2/3 */
.modal-left-content {
    flex: 2;
    position: relative;
    background-color: #0d0e23;
    overflow: hidden;
    padding: 20px;
}

.modal-close {
    position: absolute;
    top: 8px;
    right: 8px;
    background-color: #0d0e23; /* dunkler Hintergrund */
    color: #ff2e2e; /* klassisches Rot */
    border: 2px solid #ff2e2e; /* alte GUI-Optik */
    font-family: 'Share Tech Mono', monospace;
    font-size: 2rem; /* größerer X */
    font-weight: bold;
    width: 50px;
    height: 50px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    border-radius: 0; /* quadratisch, oldschool */
    box-shadow: inset -3px -3px 0 #fff, inset 3px 3px 0 #000; /* altmodischer 3D-Effekt */
    z-index: 10;
}

.modal-close:hover {
    background-color: #ff2e2e;
    color: #fff;
}

/* Hintergrundbild nur im Text Content */
.modal-left-content::before {
    content: "";
    position: absolute;
    inset: 0;
    background-image: url('rpd.png');
    background-size: cover;
    background-position: center;
    opacity: 0.1;
    pointer-events: none;
    z-index: 0;
}

/* Text über dem Hintergrund */
.modal-left-content * {
    position: relative;
    z-index: 1;
}

#modalTextWrapper {
    position: relative;
    z-index: 1; /* sicher über dem Hintergrundbild */
}

/* Image rechts 1/3 */
.image-wrapper {
    flex: 1;
    overflow: hidden;
    position: relative;
}

.image-wrapper img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}
/* Responsive */
@media(max-width:700px){
    .modal-bottom {
        flex-direction: column;
    }
    .image-wrapper {
        display: none;
    }
}

/* Typewriter Animation */
@keyframes blinkCursor {
    0%, 100% { border-color: transparent; }
    50% { border-color: #ff2e2e; }
}


.status {
    display: inline-block;
    margin-bottom: 12px;
    padding: 6px 12px;
    border-radius: 6px;
    font-weight: bold;
    font-size: 0.9rem;
}

.status.done { background: #2ecc71; color: #000; }
.status.open { background: #555; }

/* Animation */
@keyframes pop {
    from { opacity: 0; transform: scale(.9); }
    to { opacity: 1; transform: scale(1); }
}


@media(max-width: 1400px){
 .fade-in svg text {
        font-size: 20vw; /* größere Schrift auf kleinen Handys */
    }
}

/* MOBILE */
@media(max-width: 700px){
    
    #startOverlay svg text {
        font-size: 45vw; /* kleiner auf Smartphones */
    }

.game-title {
        font-size: clamp(22px, 6vw, 40px);
    }

.grid {
        padding: 0 15px; /* etwas enger auf kleinen Geräten */
    }

    h1 svg text {
        font-size: 60vw !important;
    }

.fade-in svg text {
        font-size: 35vw; /* größere Schrift auf kleinen Handys */
    }

#twitch-stream {
        margin-top: 30px; /* weniger Abstand auf mobilen Geräten */
        padding: 30px 0;
    }
     .twitch-logo {
        height: 1.3em;
    }
  .modal-content {
        grid-template-columns: 1fr; /* stapelt Text und Bild */
    }
    .image-wrapper {
        width: 100%;
        height: auto;
        box-shadow: 0 6px 15px rgba(0,0,0,0.5), 0 0 8px rgba(0,0,0,0.2);
        margin-top: 15px;
    }
    .status {
        font-size: 0.85rem;
        padding: 5px 10px;
    }
}

.status {
    display: inline-block;
    margin-bottom: 12px;
    padding: 6px 12px;
    border-radius: 6px;
    font-weight: bold;
}

/* Überschrift nur fade-in */
.fade-in {
  opacity: 0;
  transition: opacity 2.5s ease;
}

body.start .fade-in {
  opacity: 1;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.open-game {
    border-color: #ff2e2e;
    box-shadow: 0 0 25px rgba(255,46,46,0.7);
}


/* Tablets & kleinere Laptops */
@media (max-width: 900px) {
  #startOverlay text.start-stream {
    font-size: 3.5vw !important;
  }
}

/* Smartphones im Querformat */
@media (max-width: 600px) {
  #startOverlay text.start-stream {
    font-size: 4.8vw !important;
  }
}

/* Smartphones im Hochformat */
@media (max-width: 420px) {
  #startOverlay text.start-stream {
    font-size: 6vw !important;
  }
}



.status.done { background: #2ecc71; color: #000; }
.status.open { background: #555; }

@keyframes pop {
    from { opacity: 0; transform: scale(.9); }
    to { opacity: 1; transform: scale(1); }
}

@keyframes fadePulse {
  0%   { opacity: 0.2; }
  50%  { opacity: 1; }
  100% { opacity: 0.2; }
}


@media(max-width: 700px){
    .modal-content { grid-template-columns: 1fr; }
}

</style>
</head>

<body>
<div id="startOverlay">
  <svg viewBox="0 0 1200 550" xmlns="http://www.w3.org/2000/svg"
       style="width:100%; max-width:1200px; height:auto;">

    <!-- Haupttitel: Resident Evil: M -->
    <text x="50%" 
          y="40%" 
          font-family="ResidentEvil7" 
          font-size="12vw"
          text-anchor="middle"
          dominant-baseline="middle"
          fill="#f0f0f0"
          style="filter: drop-shadow(0 0 6px #000000);">

      <tspan fill="#ff2e2e">R</tspan>esident 
      <tspan fill="#ff2e2e">E</tspan>vil: M
    </text>

    <!-- Untertitel: START STREAM -->
    <text x="50%" 
          y="80%" 
          class="start-stream"
          font-family="Arial, sans-serif"
          font-size="1.2vw"
          text-anchor="middle"
          dominant-baseline="middle"
          fill="white"
          font-weight="bold"
          letter-spacing="0.22em"
          style="
            filter: 
              drop-shadow(0 0 4px black)
              drop-shadow(0 0 8px black)
              drop-shadow(0 0 14px black);
            animation: fadePulse 3s ease-in-out infinite;
          ">
      START STREAM
    </text>

  </svg>
</div>



    <div id="top-section">
<div style="text-align:center; margin-bottom:35px; margin-top:35px" class="fade-in">
  <svg viewBox="0 0 1800 200" xmlns="http://www.w3.org/2000/svg" style="width:100%; max-width:1200px; height:auto;">
    <!-- Haupttext -->
    <text x="50%" y="50%" text-anchor="middle" dominant-baseline="middle" font-family="ResidentEvil7" fill="#f0f0f0" font-size="8vw">
      <tspan fill="#ff2e2e">H</tspan>ollylp 
      <tspan fill="#ff2e2e">R</tspan>esident 
      <tspan fill="#ff2e2e">E</tspan>vil 
      <tspan fill="#ff2e2e">M</tspan>arathon
    </text>
  </svg>
</div>

<div class="grid" id="grid">

<div class="game" data-id="re1" data-img="Resident Evil 1.jpg"><img src="Resident Evil 1.jpg"><div class="game-title">Resident Evil 1</div></div>
<div class="game" data-id="re2" data-img="Resident Evil 2.png"><img src="Resident Evil 2.png"><div class="game-title">Resident Evil 2</div></div>
<div class="game" data-id="re3" data-img="Resident Evil 3.jpg"><img src="Resident Evil 3.jpg"><div class="game-title">Resident Evil 3</div></div>
<div class="game" data-id="re4" data-img="Resident Evil 4.jpg"><img src="Resident Evil 4.jpg"><div class="game-title">Resident Evil 4</div></div>
<div class="game" data-id="zero" data-img="Resident Evil Zero.jpg"><img src="Resident Evil Zero.jpg"><div class="game-title">Resident Evil Zero</div></div>

<div class="game" data-id="re1r" data-img="Resident Evil 1 Remake.jpg"><img src="Resident Evil 1 Remake.jpg"><div class="game-title">Resident Evil 1 Remake</div></div>
<div class="game" data-id="re2r" data-img="Resident Evil 2 Remake.jpg"><img src="Resident Evil 2 Remake.jpg"><div class="game-title">Resident Evil 2 Remake</div></div>
<div class="game" data-id="re3r" data-img="Resident Evil 3 Remake.jpg"><img src="Resident Evil 3 Remake.jpg"><div class="game-title">Resident Evil 3 Remake</div></div>
<div class="game" data-id="re4r" data-img="Resident Evil 4 Remake.png"><img src="Resident Evil 4 Remake.png"><div class="game-title">Resident Evil 4 Remake</div></div>

<div class="game" data-id="re5" data-img="Reisdent Evil 5.jfif"><img src="Reisdent Evil 5.jfif"><div class="game-title">Resident Evil 5</div></div>
<div class="game" data-id="re6" data-img="Resident Evil 6.png"><img src="Resident Evil 6.png"><div class="game-title">Resident Evil 6</div></div>
<div class="game" data-id="re7" data-img="Resident Evil 7.jpg"><img src="Resident Evil 7.jpg"><div class="game-title">Resident Evil 7</div></div>
<div class="game" data-id="re8" data-img="Resident Evil Village.jpg"><img src="Resident Evil Village.jpg"><div class="game-title">Resident Evil Village</div></div>

<div class="game" data-id="cv" data-img="Resident Evil Code Veronica.jpg"><img src="Resident Evil Code Veronica.jpg"><div class="game-title">Resident Evil Code: Veronica</div></div>

<div class="game" data-id="rev1" data-img="Resident Evil Revelation 1.png"><img src="Resident Evil Revelation 1.png"><div class="game-title">Resident Evil Revelations</div></div>
<div class="game" data-id="rev2" data-img="Resident Evil Revelations 2.jpg"><img src="Resident Evil Revelations 2.jpg"><div class="game-title">Resident Evil Revelations 2</div></div>

<div class="game" data-id="dead" data-img="Resident Evil Dead Aim.webp"><img src="Resident Evil Dead Aim.webp"><div class="game-title">Resident Evil Dead Aim</div></div>

<div class="game" data-id="ob1" data-img="Resident Evil Outbreak 1.jpg"><img src="Resident Evil Outbreak 1.jpg"><div class="game-title">Resident Evil Outbreak</div></div>
<div class="game" data-id="ob2" data-img="Resident Evil Outbreak 2.jpg"><img src="Resident Evil Outbreak 2.jpg"><div class="game-title">Resident Evil Outbreak File 2</div></div>

<div class="game" data-id="survivor" data-img="Reident Evil Survivor.jfif"><img src="Reident Evil Survivor.jfif"><div class="game-title">Resident Evil Survivor</div></div>
<div class="game" data-id="darkside" data-img="Resident Evil The Darkside Chronicles.jpg"><img src="Resident Evil The Darkside Chronicles.jpg"><div class="game-title">Resident Evil The Darkside Chronicles</div></div>
<div class="game" data-id="gaiden" data-img="Resident Evil Gaiden.webp"><img src="Resident Evil Gaiden.webp"><div class="game-title">Resident Evil Gaiden</div></div>

</div>
</div>

<!-- ✅ MODAL -->
<div class="modal-backdrop" id="modal">
    <div class="modal hard-edge">
        <!-- Obere Sektion: Header + GIF -->
        <div class="modal-top">
            <div class="modal-left">
                <div class="modal-header" id="modalTitle"></div>
            </div>
            <button class="modal-close" onclick="closeModal()">X</button>
        </div>


        <!-- Untere Sektion: Content + Bild -->
        <div class="modal-bottom">
            <div class="modal-left-content">
                <div id="modalTextWrapper">
                    <div id="modalStatus"></div>
                    <div id="recordingLinkDisplay" style="margin-top:10px; font-weight:bold;"></div>
                </div>
            </div>
            <div class="image-wrapper">
                <img id="modalImage" src="">
            </div>
        </div>

     </div>
</div>


<section id="twitch-stream" style="margin-top:30px; text-align:center;">
  <!-- Live auf Twitch mit Logo rechts -->
  <a href="https://www.twitch.tv/h0llylp" target="_blank" 
     style="display:inline-flex; align-items:center; gap:0.5em; text-decoration:none; justify-content:center; margin-bottom:15px; flex-wrap:wrap;">
    <h2 style="color:#9146FF; margin:0; font-size:2rem; line-height:1;">Live auf Twitch</h2>
    <img src="twitch.png" alt="Twitch" style="height:2em; width:auto; display:block;">
  </a>

  <!-- Player -->
  <div class="twitch-embed-wrapper">
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; width: 100%;">
      <iframe
        src="https://player.twitch.tv/?channel=h0llylp&parent=h0llylpmarathon.com"
        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0;"
        allowfullscreen>
      </iframe>
    </div>
  </div>
</section>



<script>
const games = document.querySelectorAll(".game");
const modal = document.getElementById("modal");
const modalImage = document.getElementById("modalImage");
const recordingDisplay = document.getElementById("recordingLinkDisplay");

const selectSound = new Audio('resident_evil_3_menu.mp3');
selectSound.volume = 0.1;

const hoverSound = new Audio('Resident-Evil-2-Cursor-Select.mp3');
hoverSound.volume = 0.1;

const typeSound = new Audio('typewriter.mp3'); // Sound für jeden Buchstaben
typeSound.volume = 0.2; // Lautstärke anpassen

// Status für alle Spiele
const data = {
    re1: "done", re2: "done", re3: "done", re4: "open", zero: "open",
    re1r: "open", re2r: "open", re3r: "open", re4r: "open",
    re5: "open", re6: "open", re7: "open", re8: "open",
    cv: "open", rev1: "open", rev2: "open", dead: "open",
    ob1: "open", ob2: "open", survivor: "done",
    darkside: "open", gaiden: "open"
};

// Aufzeichnungslinks
const recordings = {
    re1: "https://www.twitch.tv/videos/2638659125",
    re2: "https://www.twitch.tv/videos/2639472867",
    re3: "https://www.twitch.tv/videos/2640291764?t=0h0m1s",
    survivor: "https://www.twitch.tv/videos/2640291764?t=5h4m2s"
};

// ✅ Klasse 'done' direkt beim Laden setzen
games.forEach(game => {
    const id = game.dataset.id;
    if(data[id] === "done") {
        game.classList.add("done");
    } else {
        game.classList.add("open-game");
    }
});

// Overlay starten
const startOverlay = document.getElementById('startOverlay');
const introSound = new Audio('resident-evil-intro.mp3');
introSound.volume = 0.2;

startOverlay.addEventListener('click', () => {
    introSound.currentTime = 0;
    introSound.play();
    startOverlay.classList.add('flash');

    startOverlay.addEventListener('animationend', () => {
        startOverlay.classList.remove('flash');
        startOverlay.classList.add('fade-out');
        startOverlay.addEventListener('transitionend', () => {
            startOverlay.style.display = 'none';
            document.body.classList.add('start');
            const gridItems = document.querySelectorAll(".game");
            gridItems.forEach((item, index) => {
                setTimeout(() => item.classList.add('fade-in'), index * 100);
            });
        }, { once: true });
    }, { once: true });
});

// Sound für Modal-Schließen
const closeSound = new Audio('resident-evil-typewriter.mp3');
closeSound.volume = 0.1;

function closeModal() {
    modal.style.display = "none";
    games.forEach(g => g.classList.remove("active"));

    // Typewriter sofort stoppen
    typewriterController.timers.forEach(t => clearTimeout(t));
    typewriterController.timers = [];
    typewriterController.active = false;

    closeSound.currentTime = 0;
    closeSound.play();
}

modal.addEventListener("click", e => {
    if(e.target === modal) closeModal();
});

document.addEventListener("keydown", e => {
    if(e.key === "Escape") closeModal();
});

const typewriterController = {
    timers: [],
    active: true // Flag, ob Typewriter gerade aktiv ist
};

function typeWriterHTML(element, htmlText, speed = 50, callback) {
    // Alte Timer löschen
    typewriterController.active = true;
    typewriterController.timers.forEach(t => clearTimeout(t));
    typewriterController.timers = [];

    element.innerHTML = ""; // vorher leeren
    const tempDiv = document.createElement('div');
    tempDiv.innerHTML = htmlText;
    const nodes = Array.from(tempDiv.childNodes);

    function typeNode(nodeIndex, charIndex) {
        if (!typewriterController.active) return;
        if (nodeIndex >= nodes.length) {
            if(callback) callback();
            return;
        }

        const node = nodes[nodeIndex];

        if(node.nodeType === Node.TEXT_NODE) {
            const char = node.textContent.charAt(charIndex);
            element.innerHTML += char;

            // ✅ Neuer Audio-Instanz für jeden Buchstaben
            if(char.trim() !== "") {
                if(typewriterController.active) {
                    const sound = new Audio('typewriter.mp3');
                    sound.volume = 0.1;
                    sound.play();
                }
            }

            charIndex++;
            let delay = char === "." ? 200 : speed;
            if(charIndex < node.textContent.length) {
                const t = setTimeout(() => typeNode(nodeIndex, charIndex), delay);
                typewriterController.timers.push(t);
            } else {
                typeNode(nodeIndex + 1, 0);
            }
        } else if(node.nodeType === Node.ELEMENT_NODE) {
            const tag = document.createElement(node.nodeName);
            for(let attr of node.attributes) tag.setAttribute(attr.name, attr.value);
            element.appendChild(tag);
            typeWriterHTML(tag, node.innerHTML, speed, () => typeNode(nodeIndex + 1, 0));
        }
    }

    typeNode(0, 0);
}


// Spiele Klick Event
games.forEach(game => {
    game.addEventListener("mouseenter", () => {
        const sound = new Audio('Resident-Evil-2-Cursor-Select.mp3');
        sound.volume = 0.1;
        sound.play();
    });

    game.addEventListener("click", () => {
        selectSound.currentTime = 0;
        selectSound.play();

        // Active-Klasse setzen
        games.forEach(g => g.classList.remove("active"));
        game.classList.add("active");

        const id = game.dataset.id;
        const title = game.innerText;
        const img = game.dataset.img;
        const state = data[id];

        const missionStatus = state === "done" ? "Erfolgreich" : "Ausstehend";
        const missionColor = state === "done" ? "green" : "red";
        const recordingLink = recordings[id];

        // Lade-Text vorbereiten
        const loadingLines = [
            "Login...",
            "Username: H0llyLP",
            "Passwort: *****",
            "...",
            "H0llyLP erfolgreich autorisiert...",
            "Lade Missionsdaten...",
            `${title} Speicherdaten werden geladen...`,
            `<span style="color:${missionColor}; font-weight:bold;">Mission: ${missionStatus}</span>`
        ];

        if(recordingLink) {
            let linkText = "Twitch";
            let linkColor = "#6441a5";

            if(recordingLink.includes("youtube.com") || recordingLink.includes("youtu.be")) {
                linkText = "YouTube";
                linkColor = "#CD201F";
            }

            loadingLines.push(`<span style="white-space: nowrap;">Zur Mission: <a href="${recordingLink}" target="_blank" style="color:${linkColor}; text-decoration:underline;">${linkText}</a></span>`);
        }

        // Modal öffnen
        modal.style.display = "flex";

        // Modal-Header direkt setzen (kein Typewriter)
        const modalHeader = document.getElementById("modalTitle");
        modalHeader.innerHTML = title;

        // Modal-Body tippen
        recordingDisplay.innerHTML = "";
        typeWriterLinesInline(loadingLines, recordingDisplay, 50, 400);

        // Bild setzen
        modalImage.src = img;
    });
});


function typeWriterLinesInline(lines, element, speed = 50, lineDelay = 400) {
    let lineIndex = 0;

    // Alte Timer löschen
    typewriterController.timers.forEach(t => clearTimeout(t));
    typewriterController.timers = [];

    function typeLine() {
        if (lineIndex >= lines.length) return;

        const span = document.createElement("span");
        element.appendChild(span);

        typeWriterHTML(span, lines[lineIndex], speed, () => {
            if (!lines[lineIndex].includes('white-space: nowrap')) {
                element.appendChild(document.createElement("br"));
            }
            lineIndex++;
            const t = setTimeout(typeLine, lineDelay);
            typewriterController.timers.push(t);
        });
    }

    typeLine();
}



</script>

</body>
</html>





